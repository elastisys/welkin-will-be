
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Kubernetes platform to comply with Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001." name="description"/>
<meta content="Elastisys AB" name="author"/>
<link href="https://elastisys.io/compliantkubernetes/operator-manual/maintenance/" rel="canonical"/>
<link href="../clock-synchronization/" rel="prev"/>
<link href="../clean-up/" rel="next"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.4.6" name="generator"/>
<title>Maintenance - Elastisys Compliant Kubernetes</title>
<link href="../../assets/stylesheets/main.35e1ed30.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.356b1318.min.css" rel="stylesheet"/>
<link href="../../stylesheets/branding.css" rel="stylesheet"/>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://matomo.elastisys.com/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
<meta content="website" property="og:type"/>
<meta content="Maintenance - Elastisys Compliant Kubernetes" property="og:title"/>
<meta content="Kubernetes platform to comply with Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001." property="og:description"/>
<meta content="https://elastisys.io/compliantkubernetes/assets/images/social/operator-manual/maintenance.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1200" property="og:image:width"/>
<meta content="630" property="og:image:height"/>
<meta content="https://elastisys.io/compliantkubernetes/operator-manual/maintenance/" property="og:url"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="Maintenance - Elastisys Compliant Kubernetes" name="twitter:title"/>
<meta content="Kubernetes platform to comply with Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001." name="twitter:description"/>
<meta content="https://elastisys.io/compliantkubernetes/assets/images/social/operator-manual/maintenance.png" name="twitter:image"/>
<meta content="
  default-src 'self';
  style-src 'self' 'unsafe-inline';
  img-src 'self' data:;
  connect-src 'self' https://matomo.elastisys.com/;
  script-src 'self' 'unsafe-inline' https://matomo.elastisys.com/;
" http-equiv="Content-Security-Policy"/>
<!-- Disable localStorage, sessionStorage and cookies -->
<script>
if (window.localStorage) {
  window.localStorage.setItem = function() { };
  window.localStorage.clear();
}
if (window.sessionStorage) {
  window.sessionStorage.setItem = function() { }
  window.sessionStorage.clear();
}
if(!document.__defineGetter__) {
  Object.defineProperty(document, 'cookie', {
    get: function(){return ''},
    set: function(){return true},
  });
} else {
  document.__defineGetter__("cookie", function() { return '';} );
  document.__defineSetter__("cookie", function() {} );
}
</script>
<!-- See https://realfavicongenerator.net -->
<link href="https://elastisys.io/compliantkubernetes/img/apple-touch-icon.png?v=1" rel="apple-touch-icon" sizes="180x180"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon-32x32.png?v=1" rel="icon" sizes="32x32" type="image/png"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon-16x16.png?v=1" rel="icon" sizes="16x16" type="image/png"/>
<link href="https://elastisys.io/compliantkubernetes/img/site.webmanifest?v=1" rel="manifest"/>
<link color="#5bbad5" href="https://elastisys.io/compliantkubernetes/img/safari-pinned-tab.svg?v=1" rel="mask-icon"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon.ico?v=1" rel="shortcut icon"/>
<meta content="#2b5797" name="msapplication-TileColor"/>
<meta content="https://elastisys.io/compliantkubernetes/img/browserconfig.xml?v=1" name="msapplication-config"/>
<meta content="#ffffff" name="theme-color"/>
<link href="../../assets/stylesheets/extra-style.vsevg32e.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="elastisys" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#maintaining-and-upgrading-your-compliant-kubernetes-environment">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Elastisys Compliant Kubernetes" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Elastisys Compliant Kubernetes">
<img alt="logo" src="../../img/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Elastisys Compliant Kubernetes
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Maintenance
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<ul class="header-links">
<li>
<a href="https://github.com/elastisys/compliantkubernetes/">
<img alt="Git logo" src="../../img/git-alt.svg" width="25px">
</img></a>
</li>
<li><a class="menu-callout" href="https://elastisys.com/">Try out Managed<br/>Compliant Kubernetes</a></li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Elastisys Compliant Kubernetes" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Elastisys Compliant Kubernetes">
<img alt="logo" src="../../img/logo.png"/>
</a>
    Elastisys Compliant Kubernetes
  </label>
<div class="md-nav__source">
<ul class="header-links">
<li>
<a href="https://github.com/elastisys/compliantkubernetes/">
<img alt="Git logo" src="../../img/git-alt.svg" width="25px">
</img></a>
</li>
<li><a class="menu-callout" href="https://elastisys.com/">Try out Managed<br/>Compliant Kubernetes</a></li>
</ul>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    For Application Developers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            For Application Developers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
<span class="md-ellipsis">
    Getting Started
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/prepare/">
<span class="md-ellipsis">
    Step 1: Prepare
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/deploy/">
<span class="md-ellipsis">
    Step 2: Deploy
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/operate/">
<span class="md-ellipsis">
    Step 3: Operate
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Go Deeper
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
            Go Deeper
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/prepare-application/">
<span class="md-ellipsis">
    Prepare Your Application
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/prepare-idp/">
<span class="md-ellipsis">
    Prepare Your Identity Provider (IdP)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/registry/">
<span class="md-ellipsis">
    Container registry
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/continous-development/">
<span class="md-ellipsis">
    Continous Development
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/network-model/">
<span class="md-ellipsis">
    Network Model
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/kubernetes-api/">
<span class="md-ellipsis">
    Kubernetes API
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/kubernetes-ui/">
<span class="md-ellipsis">
    Kubernetes UI (Lens)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/namespaces/">
<span class="md-ellipsis">
    Namespaces
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/logs/">
<span class="md-ellipsis">
    Logs
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/log-based-alerts/">
<span class="md-ellipsis">
    Log-based Alerts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/long-term-log-retention/">
<span class="md-ellipsis">
    Long-term Log Retention
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/metrics/">
<span class="md-ellipsis">
    Metrics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/alerts/">
<span class="md-ellipsis">
    Metric Alerts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/maintenance/">
<span class="md-ellipsis">
    Maintenance
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/backup/">
<span class="md-ellipsis">
    Backups
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/ci-cd/">
<span class="md-ellipsis">
    CI/CD
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/demarcation/">
<span class="md-ellipsis">
    Demarcation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/delegation/">
<span class="md-ellipsis">
    How to Delegate
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/how-many-environments/">
<span class="md-ellipsis">
    How many environments?
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
<span class="md-ellipsis">
    Safeguards
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
            Safeguards
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/enforce-no-root/">
<span class="md-ellipsis">
    Enforce No Root
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/enforce-podsecuritypolicies/">
<span class="md-ellipsis">
    Enforce Restricted Privileges
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/enforce-networkpolicies/">
<span class="md-ellipsis">
    Enforce NetworkPolicies
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/enforce-resources/">
<span class="md-ellipsis">
    Enforce Resources
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/enforce-trusted-registries/">
<span class="md-ellipsis">
    Enforce Trusted Registries
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/enforce-no-latest-tag/">
<span class="md-ellipsis">
    Enforce No Latest Tag
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/safeguards/enforce-job-ttl/">
<span class="md-ellipsis">
    Enforce Job TTL
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
<span class="md-ellipsis">
    Additional Services
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
            Additional Services
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/additional-services/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/additional-services/postgresql/">
<span class="md-ellipsis">
    PostgreSQL
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/additional-services/timescaledb/">
<span class="md-ellipsis">
    TimescaleDB
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/additional-services/redis/">
<span class="md-ellipsis">
    Redis
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/additional-services/rabbitmq/">
<span class="md-ellipsis">
    RabbitMQ
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/additional-services/jaeger/">
<span class="md-ellipsis">
    Jaeger (preview)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/additional-services/argocd/">
<span class="md-ellipsis">
    Argo CD (preview)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
<span class="md-ellipsis">
    Self-Managed Services
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
            Self-Managed Services
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/self-managed-services/ferretdb/">
<span class="md-ellipsis">
    FerretDB (self-managed)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/self-managed-services/keycloak/">
<span class="md-ellipsis">
    Keycloak (self-managed)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/self-managed-services/jupyterhub/">
<span class="md-ellipsis">
    JupyterHub (self-managed)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/self-managed-services/sealedsecrets/">
<span class="md-ellipsis">
    SealedSecrets (self-managed)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/self-managed-services/mongodb/">
<span class="md-ellipsis">
    MongoDB (self-managed)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/self-managed-services/sjunet/">
<span class="md-ellipsis">
    SjuNet (self-managed)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/go-live/">
<span class="md-ellipsis">
    Go-live Checklist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-guide/faq/">
<span class="md-ellipsis">
    FAQ
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    For Platform Administrators
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            For Platform Administrators
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../getting-started/">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../provider-audit/">
<span class="md-ellipsis">
    Provider Audit
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../on-prem-standard/">
<span class="md-ellipsis">
    Standard Template for on-prem Environment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../qa/">
<span class="md-ellipsis">
    QA
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
<span class="md-ellipsis">
    Advanced Configuration
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
            Advanced Configuration
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../configure/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cluster-sizing/">
<span class="md-ellipsis">
    Sizing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ingress/">
<span class="md-ellipsis">
    Ingress
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../access-control/">
<span class="md-ellipsis">
    Access Control
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user-alerts/">
<span class="md-ellipsis">
    User Alerts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../user-manged-crds/">
<span class="md-ellipsis">
    User Managed CRDs (preview)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../disaster-recovery/">
<span class="md-ellipsis">
    Disaster Recovery
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../break-glass/">
<span class="md-ellipsis">
    Breaking the Glass
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cryptography/">
<span class="md-ellipsis">
    Use of Cryptography
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../credentials/">
<span class="md-ellipsis">
    Use of Credentials
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../capacity-management/">
<span class="md-ellipsis">
    Capacity Management
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../clock-synchronization/">
<span class="md-ellipsis">
    Clock Synchronization
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Maintenance
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Maintenance
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#compliance-needs">
    Compliance needs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-maintenance-do-i-need-to-do-and-how">
    What maintenance do I need to do and how?
  </a>
<nav aria-label="What maintenance do I need to do and how?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#patching-the-nodes">
    Patching the nodes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-the-compliant-kubernetes-application-stack">
    Upgrading the Compliant Kubernetes application stack
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
    Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-compliantkubernetes-apps">
    Upgrading compliantkubernetes-apps
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-kubespraykubernetes">
    Upgrading Kubespray/Kubernetes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#after-doing-any-upgrades-or-maintenance">
    After doing any upgrades or maintenance
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../clean-up/">
<span class="md-ellipsis">
    Clean Up
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../faq/">
<span class="md-ellipsis">
    FAQ
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../additional-services/">
<span class="md-ellipsis">
    Additional Services
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    For CISOs and DPOs
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            For CISOs and DPOs
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/gdpr/">
<span class="md-ellipsis">
    GDPR (EU)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/iso-27001/">
<span class="md-ellipsis">
    ISO 27001 (EU)
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
<span class="md-ellipsis">
    Healthcare
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_4">
<span class="md-nav__icon md-icon"></span>
            Healthcare
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/hslf-fs-201640/">
<span class="md-ellipsis">
    HSLF-FS 2016:40 (SE)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/hipaa/">
<span class="md-ellipsis">
    HIPAA (US)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/mdr/">
<span class="md-ellipsis">
    MDR (EU)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
<span class="md-ellipsis">
    Public sector
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_5">
<span class="md-nav__icon md-icon"></span>
            Public sector
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/msbfs-20207/">
<span class="md-ellipsis">
    MSBFS 2020:7 (SE)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
<span class="md-ellipsis">
    NIS2
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_6">
<span class="md-nav__icon md-icon"></span>
            NIS2
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/kritis/">
<span class="md-ellipsis">
    KRITIS (DE)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/bsi-it-grundschutz/">
<span class="md-ellipsis">
    BSI IT-Grundschutz (DE)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/controls/msbfs-20188/">
<span class="md-ellipsis">
    MSBFS 2018:8 (SE)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
<span class="md-ellipsis">
    CISO Dashboards
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_7">
<span class="md-nav__icon md-icon"></span>
            CISO Dashboards
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/audit-logs/">
<span class="md-ellipsis">
    Audit Logs
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/backup/">
<span class="md-ellipsis">
    Backup Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/cryptography/">
<span class="md-ellipsis">
    Cryptography Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/intrusion-detection/">
<span class="md-ellipsis">
    Intrusion Detection Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/policy-as-code/">
<span class="md-ellipsis">
    Policy-as-Code Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/network-security/">
<span class="md-ellipsis">
    Network Security Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/capacity-management/">
<span class="md-ellipsis">
    Capacity Management (Kubernetes Status) Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/vulnerability/">
<span class="md-ellipsis">
    Vulnerability Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/log-review/">
<span class="md-ellipsis">
    Log Review
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/faq/">
<span class="md-ellipsis">
    FAQ
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ciso-guide/gdpr-art-17/">
<span class="md-ellipsis">
    How do I comply with GDPR Art. 17 Right to erasure ("right to be forgotten")?
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    For Contributors
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            For Contributors
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contributor-guide/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/">
<span class="md-ellipsis">
    Architecture
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../adr/">
<span class="md-ellipsis">
    Architectural Decision Log
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tech-radar/">
<span class="md-ellipsis">
    Tech Radar
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Release Notes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Release Notes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/ck8s/">
<span class="md-ellipsis">
    Compliant Kubernetes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/kubespray/">
<span class="md-ellipsis">
    CK8S Kubespray
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/postgres/">
<span class="md-ellipsis">
    CK8S PostgreSQL
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/rabbitmq/">
<span class="md-ellipsis">
    CK8S RabbitMQ
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/redis/">
<span class="md-ellipsis">
    CK8S Redis
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/jaeger/">
<span class="md-ellipsis">
    CK8S Jaeger
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release-notes/argocd/">
<span class="md-ellipsis">
    CK8S Argo CD
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../glossary/">
<span class="md-ellipsis">
    Glossary
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../roadmap/">
<span class="md-ellipsis">
    Roadmap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/">
<span class="md-ellipsis">
    Support
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/training/">
<span class="md-ellipsis">
    Training
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/blog/">
<span class="md-ellipsis">
    Blog
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/legal/privacy-policy/">
<span class="md-ellipsis">
    Privacy Policy
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#compliance-needs">
    Compliance needs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-maintenance-do-i-need-to-do-and-how">
    What maintenance do I need to do and how?
  </a>
<nav aria-label="What maintenance do I need to do and how?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#patching-the-nodes">
    Patching the nodes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-the-compliant-kubernetes-application-stack">
    Upgrading the Compliant Kubernetes application stack
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
    Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-compliantkubernetes-apps">
    Upgrading compliantkubernetes-apps
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#upgrading-kubespraykubernetes">
    Upgrading Kubespray/Kubernetes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#after-doing-any-upgrades-or-maintenance">
    After doing any upgrades or maintenance
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<nav class="md-tags">
<a class="md-tag" href="../../ciso-guide/controls/iso-27001/#iso-27001-a1261-management-of-technical-vulnerabilities">ISO 27001 A.12.6.1 Management of Technical Vulnerabilities</a>
<a class="md-tag" href="../../ciso-guide/controls/bsi-it-grundschutz/#bsi-it-grundschutz-app44a21">BSI IT-Grundschutz APP.4.4.A21</a>
<a class="md-tag" href="../../ciso-guide/controls/hipaa/#hipaa-s16-security-awareness-and-training-security-reminders-164308a5iia">HIPAA S16 - Security Awareness and Training - Security Reminders - § 164.308(a)(5)(ii)(A)</a>
<a class="md-tag" href="../../ciso-guide/controls/msbfs-20207/#msbfs-20207-4-kap-12">MSBFS 2020:7 4 kap. 12 §</a>
</nav>
<h1 id="maintaining-and-upgrading-your-compliant-kubernetes-environment">Maintaining and Upgrading your Compliant Kubernetes environment.<a class="headerlink" href="#maintaining-and-upgrading-your-compliant-kubernetes-environment" title="Permanent link">¶</a></h1>
<p>In order to keep your Compliant Kubernetes environment running smoothly, and to assure that you are up to date with the latest patches you need to perform regular maintenance on it.</p>
<p>This guide assumes that:</p>
<ul>
<li>Your Compliant Kubernetes environment is running normally, if not, please see the <a href="../troubleshooting/">Troubleshooting guide</a>.</li>
<li>Your Compliant Kubernetes environment is properly <a href="../cluster-sizing/">sized</a></li>
<li>You have performed the actions in the <a href="../../user-guide/go-live/">Go-live Checklist</a> as failure to do so might cause downtime during maintenance.</li>
</ul>
<h2 id="compliance-needs">Compliance needs<a class="headerlink" href="#compliance-needs" title="Permanent link">¶</a></h2>
<p>Many regulations require you to secure your information system against unauthorized access, data loss, and breaches.
An important part of this is keeping your Compliant Kubernetes environment up to date with the latest security patches not run outdated versions of components that are no longer supported.
This maps to objectives in ISO Annex <a href="https://www.isms.online/iso-27001/annex-a-12-operations-security/">A.12.6.1 Management of Technical Vulnerabilities</a>.</p>
<h2 id="what-maintenance-do-i-need-to-do-and-how">What maintenance do I need to do and how?<a class="headerlink" href="#what-maintenance-do-i-need-to-do-and-how" title="Permanent link">¶</a></h2>
<p>In short, there are three levels of maintenance that should be performed on a regular basis.</p>
<ul>
<li>Patching the underlying OS on the nodes</li>
<li>Upgrading the Compliant Kubernetes application stack</li>
<li>Upgrading Compliant Kubernetes-Kubespray</li>
</ul>
<p>Let's go through them one by one.</p>
<h3 id="patching-the-nodes">Patching the nodes<a class="headerlink" href="#patching-the-nodes" title="Permanent link">¶</a></h3>
<p>Security patches for the underlying OS on the nodes is constantly being released, and to ensure your environment is secured, the nodes that run Compliant Kubernetes must be updated with these patches.
We recommend that you use the <a href="https://help.ubuntu.com/community/AutomaticSecurityUpdates">AutomaticSecurityUpdates</a> feature that is available in Ubuntu (similar feature exist in other distros) to install these updates.
Note that the nodes still need to be rebooted for some of these updates to be applied.
In order to reboot the nodes, you can either use a tool like <a href="https://github.com/kubereboot/kured">kured</a> or you can do it manually by logging on to the nodes and rebooting them manually.
When doing that, reboot one node at the time and make sure that the rebooted node is 'Ready' and that pods are scheduled to it before you move on to the next, or you risk downtime.</p>
<p>There is a playbook in the compliantkubernetes-kubespray repo that can assist with the reboot of nodes.
It will cordon and reboot the nodes one by one.</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s-kubespray<span class="w"> </span>reboot-nodes<span class="w"> </span>&lt;prefix&gt;<span class="w"> </span><span class="o">[</span>--extra-vars<span class="w"> </span><span class="nv">manual_prompt</span><span class="o">=</span>true<span class="o">]</span><span class="w"> </span><span class="o">[</span>&lt;options&gt;<span class="o">]</span>
</code></pre></div>
<h3 id="upgrading-the-compliant-kubernetes-application-stack">Upgrading the Compliant Kubernetes application stack<a class="headerlink" href="#upgrading-the-compliant-kubernetes-application-stack" title="Permanent link">¶</a></h3>
<p>Compliant Kubernetes consists of a multitude of open source components that interact to form a smooth End User experience.
In order to free you of the burden of keeping track of when to upgrade the various components, new versions of Complaint Kubernetes are regularly release.
When a new version is released, it becomes available as a <a href="https://github.com/elastisys/compliantkubernetes-apps/tags">tagged release</a> in the GitHub repo.</p>
<blockquote>
<p>Before upgrading to a new release, please review the <a href="https://github.com/elastisys/compliantkubernetes-apps/blob/main/CHANGELOG.md">changelog</a> if possible, apply the upgrade to a staging environment before upgrading any environments with production data.</p>
</blockquote>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¶</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Notify the users (if any) before the upgrade starts;</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check if there are any pending changes to the environment;</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check the state of the environment, pods, nodes and backup jobs:</li>
</ul>
<blockquote>
<p><strong><em>NOTE:</em></strong> the below steps should be run from compliantkubernetes-apps root directory</p>
</blockquote>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span><span class="nb">test</span><span class="w"> </span>sc<span class="p">|</span>wc
./bin/ck8s<span class="w"> </span>ops<span class="w"> </span>kubectl<span class="w"> </span>sc<span class="p">|</span>wc<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-A<span class="w"> </span>-o<span class="w"> </span>custom-columns<span class="o">=</span>NAMESPACE:metadata.namespace,POD:metadata.name,READY-false:status.containerStatuses<span class="o">[</span>*<span class="o">]</span>.ready,REASON:status.containerStatuses<span class="o">[</span>*<span class="o">]</span>.state.terminated.reason<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>Completed
./bin/ck8s<span class="w"> </span>ops<span class="w"> </span>kubectl<span class="w"> </span>sc<span class="p">|</span>wc<span class="w"> </span>get<span class="w"> </span>nodes
./bin/ck8s<span class="w"> </span>ops<span class="w"> </span>kubectl<span class="w"> </span>sc<span class="p">|</span>wc<span class="w"> </span>get<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>-A
velero<span class="w"> </span>get<span class="w"> </span>backup
</code></pre></div>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Silence the notifications for the alerts. e.g you can use <a href="https://prometheus.io/docs/alerting/latest/alertmanager/#silences">alertmanager silences</a>;</li>
</ul>
<h3 id="upgrading-compliantkubernetes-apps">Upgrading compliantkubernetes-apps<a class="headerlink" href="#upgrading-compliantkubernetes-apps" title="Permanent link">¶</a></h3>
<p>For security, compliance, and support reasons, environments should stay up to date with the latest version of <a href="https://github.com/elastisys/compliantkubernetes-apps">compliankubernetes-apps</a>.</p>
<p>Note what version of compliantkubernetes-apps that is currently used and the version that you want to upgrade to.
Then check the release notes for each version in between to see if there are anything that might cause any problems, if so then consult the rest of the operations team before proceeding.
<strong>You should never upgrade more than one minor version of compliantkubernetes-apps at a time.</strong></p>
<ol>
<li>
<p>Pull the latest changes and switch to the correct branch:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>pull
git<span class="w"> </span>switch<span class="w"> </span>-d<span class="w"> </span>&lt;next-version&gt;
</code></pre></div>
</li>
<li>
<p>Update apps configuration:</p>
<p>This will take a backup into <code>backups/</code> before modifying any files.</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span>init
</code></pre></div>
</li>
<li>
<p>Check if there is a <a href="https://github.com/elastisys/compliantkubernetes-apps/tree/main/migration">migration document</a> for the release you want to upgrade to, (e.g. <a href="https://github.com/elastisys/compliantkubernetes-apps/blob/5d8f4f1b3cc053b3b515711549ab80df9617f2f4/migration/v0.10.x-v0.11.x/upgrade-apps.md">for upgrade to 0.11.0</a> ) and follow the instructions there.
Note that you should check the documentation at the release tag instead of <code>main</code> to be sure that it's correct.</p>
</li>
<li>
<p>If there is no relevant migration document, first do a dry-run.</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span>dry-run<span class="w"> </span>sc
./bin/ck8s<span class="w"> </span>dry-run<span class="w"> </span>wc
</code></pre></div>
</li>
<li>
<p>If dry-run reports no errors, proceed with the upgrade.</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span>apply<span class="w"> </span>sc
./bin/ck8s<span class="w"> </span>apply<span class="w"> </span>wc
</code></pre></div>
</li>
<li>
<p>Verify that everything is running after the upgrade.
At the minimum, at least run the tests in compliantkubernetes-apps.</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span><span class="nb">test</span><span class="w"> </span>sc
./bin/ck8s<span class="w"> </span><span class="nb">test</span><span class="w"> </span>wc
</code></pre></div>
</li>
<li>
<p>Go back to step 1 and repeat one new release of compliantkubernetes-apps at a time until you are at the latest release.</p>
</li>
</ol>
<h3 id="upgrading-kubespraykubernetes">Upgrading Kubespray/Kubernetes<a class="headerlink" href="#upgrading-kubespraykubernetes" title="Permanent link">¶</a></h3>
<p>All clusters should stay up to date with the latest Kubespray version used in <a href="https://github.com/elastisys/compliantkubernetes-kubespray">compliantkubernetes-kubespray</a>.</p>
<ol>
<li>
<p>Note what version of Kubespray that is currently used in the cluster and the Kubespray version we want to upgrade to.
Then check the release notes for each version in between to see if there are anything that might cause any problems, if so then consult the rest of the operations team before proceeding.
Also check if the newer Kubespray version would upgrade Kubernetes to a new minor version, if so then the Application Developer should get a notice of x weeks before proceeding to let them check for any deprecated APIs that they might be using.
You should never upgrade more than one patch version of Kubespray at a time.
E.g. if you are at Kubespray version 2.13.3 and are going to 2.15.0 then the upgrade path would be 2.13.3 -&gt; 2.13.4 -&gt; 2.14.0 -&gt; 2.14.1 -&gt; 2.14.2 -&gt; 2.15.0.
Patches that are released to an older minor version can be skipped, e.g. new patches to 2.14 after 2.15 has been released.
Read more about Kubespray upgrades in their <a href="https://kubespray.io/#/docs/upgrades">documentation</a>.</p>
</li>
<li>
<p>Checkout the next Kubespray version by checking out the last compliantkubernetes-kubespray commit (the commit is <code>next-version</code> in the snippet below) that used that version and updating the submodule.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># you should be in the root folder of compliantkubernetes-kubespray</span>
git<span class="w"> </span>switch<span class="w"> </span>-d<span class="w"> </span>&lt;next-version&gt;
git<span class="w"> </span>submodule<span class="w"> </span>sync
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
</code></pre></div>
</li>
<li>
<p>Upgrade compliantkubernetes-kubespray by following the relevant <a href="https://github.com/elastisys/compliantkubernetes-kubespray/tree/main/migration">documentation</a> (e.g. <a href="https://github.com/elastisys/compliantkubernetes-kubespray/blob/v2.17.1-ck8s1/migration/v2.16.0-ck8s1-v2.17.x-ck8s1/upgrade-cluster.md">for upgrade to v2.17.x-ck8s1</a>).</p>
</li>
<li>
<p>Download the required files on the nodes</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s-kubespray<span class="w"> </span>run-playbook<span class="w"> </span>sc<span class="w"> </span>upgrade-cluster.yml<span class="w"> </span>-b<span class="w"> </span>--tags<span class="o">=</span>download
./bin/ck8s-kubespray<span class="w"> </span>run-playbook<span class="w"> </span>wc<span class="w"> </span>upgrade-cluster.yml<span class="w"> </span>-b<span class="w"> </span>--tags<span class="o">=</span>download
</code></pre></div>
</li>
<li>
<p>Upgrade the cluster to a new Kubernetes version:</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s-kubespray<span class="w"> </span>run-playbook<span class="w"> </span>sc<span class="w"> </span>upgrade-cluster.yml<span class="w"> </span>-b<span class="w"> </span>--skip-tags<span class="o">=</span>download
./bin/ck8s-kubespray<span class="w"> </span>run-playbook<span class="w"> </span>wc<span class="w"> </span>upgrade-cluster.yml<span class="w"> </span>-b<span class="w"> </span>--skip-tags<span class="o">=</span>download
</code></pre></div>
</li>
</ol>
<h3 id="after-doing-any-upgrades-or-maintenance">After doing any upgrades or maintenance<a class="headerlink" href="#after-doing-any-upgrades-or-maintenance" title="Permanent link">¶</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check the state of the environment, pods and nodes:</li>
</ul>
<blockquote>
<p><strong><em>NOTE:</em></strong> the below steps should be run from compliantkubernetes-apps root directory</p>
</blockquote>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span><span class="nb">test</span><span class="w"> </span>sc<span class="p">|</span>wc
./bin/ck8s<span class="w"> </span>ops<span class="w"> </span>kubectl<span class="w"> </span>sc<span class="p">|</span>wc<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-A<span class="w"> </span>-o<span class="w"> </span>custom-columns<span class="o">=</span>NAMESPACE:metadata.namespace,POD:metadata.name,READY-false:status.containerStatuses<span class="o">[</span>*<span class="o">]</span>.ready,REASON:status.containerStatuses<span class="o">[</span>*<span class="o">]</span>.state.terminated.reason<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>Completed
./bin/ck8s<span class="w"> </span>ops<span class="w"> </span>kubectl<span class="w"> </span>sc<span class="p">|</span>wc<span class="w"> </span>get<span class="w"> </span>nodes
</code></pre></div>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check if any alerts generated by the upgrade didn't close;</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check if you can login to Grafana, Opensearch or Harbor;</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Enable the notifications for the alerts;</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Notify the users (if any) when the upgrade is complete;</li>
<li class="task-list-item"><label class="task-list-control"><input disabled="" type="checkbox"><span class="task-list-indicator"></span></input></label> Check that you can see fresh metrics and logs.</li>
</ul>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Clock Synchronization" class="md-footer__link md-footer__link--prev" href="../clock-synchronization/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Clock Synchronization
              </div>
</div>
</a>
<a aria-label="Next: Clean Up" class="md-footer__link md-footer__link--next" href="../clean-up/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Clean Up
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © Elastisys AB <br/> The Linux Foundation has the following registered trademarks in the United States and/or other countries: Certified Kubernetes®, containerd®, fluentd®, Helm®, Istio®, K8s®, Kubernetes®, Prometheus®, PromQL®, Rook®, The Linux Foundation®. <br/> The Linux Foundation has registrations pending or trademarks in use for the following marks in the United States and/or other countries: Argo™, CoreDNS™, Falco™, Harbor™, Jaeger™, Linux Foundation™, OpenTelemetry™, OpenTracing™, Open Policy Agent™, Tekton™, Thanos™. <br/> Postgres and PostgreSQL and the Elephant Logo (Slonik) are all registered trademarks of the PostgreSQL Community Association of Canada. <br/> Redis is a trademark of Redis Ltd. Any rights therein are reserved to Redis Ltd. Any use by the Compliant Kubernetes project is for referential purposes only and does not indicate any sponsorship, endorsement or affiliation between Redis and Compliant Kubernetes project. <br/> RabbitMQ is a trademark of VMware, Inc. in the U.S. and other countries. <br/> TimescaleDB and the EON mascot are trademarks of <a href="https://www.timescale.com/">Timescale, Inc.</a> <br/> FerretDB® is a registered trademark of FerretDB, Inc. FerretDB Inc. is not affiliated, associated, authorized, endorsed by, or in any way officially connected with MongoDB Inc., or any of its subsidiaries or its affiliates. <br/> MongoDB, Mongo, and the leaf logo are registered trademarks of MongoDB, Inc. <br/> Keycloak™ is a trademark of Red Hat Inc. <br/> OpenSearch is a registered trademark of Amazon Web Services. <br/> NGINX is a registered trademark of F5 Inc.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "navigation.footer", "navigation.top"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
<script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
</body>
</html>