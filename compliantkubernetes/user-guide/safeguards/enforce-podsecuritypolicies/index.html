
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Kubernetes platform to comply with Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001." name="description"/>
<meta content="Elastisys AB" name="author"/>
<link href="https://elastisys.io/compliantkubernetes/user-guide/safeguards/enforce-podsecuritypolicies/" rel="canonical"/>
<link href="../enforce-no-root/" rel="prev"/>
<link href="../enforce-networkpolicies/" rel="next"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.1.21" name="generator"/>
<title>Enforce Restricted Privileges - Elastisys Compliant Kubernetes</title>
<link href="../../../assets/stylesheets/main.eebd395e.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.ecc896b0.min.css" rel="stylesheet"/>
<link href="../../../stylesheets/branding.css" rel="stylesheet"/>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://matomo.elastisys.com/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '2']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->
<meta content="website" property="og:type"/>
<meta content="Enforce Restricted Privileges - Elastisys Compliant Kubernetes" property="og:title"/>
<meta content="Kubernetes platform to comply with Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001." property="og:description"/>
<meta content="https://elastisys.io/compliantkubernetes/assets/images/social/user-guide/safeguards/enforce-podsecuritypolicies.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1200" property="og:image:width"/>
<meta content="630" property="og:image:height"/>
<meta content="https://elastisys.io/compliantkubernetes/user-guide/safeguards/enforce-podsecuritypolicies/" property="og:url"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="Enforce Restricted Privileges - Elastisys Compliant Kubernetes" name="twitter:title"/>
<meta content="Kubernetes platform to comply with Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001." name="twitter:description"/>
<meta content="https://elastisys.io/compliantkubernetes/assets/images/social/user-guide/safeguards/enforce-podsecuritypolicies.png" name="twitter:image"/>
<meta content="
  default-src 'self';
  style-src 'self' 'unsafe-inline';
  img-src 'self' data:;
  connect-src 'self' https://matomo.elastisys.com/;
  script-src 'self' 'unsafe-inline' https://matomo.elastisys.com/;
" http-equiv="Content-Security-Policy"/>
<!-- Disable localStorage, sessionStorage and cookies -->
<script>
if (window.localStorage) {
  window.localStorage.setItem = function() { };
  window.localStorage.clear();
}
if (window.sessionStorage) {
  window.sessionStorage.setItem = function() { }
  window.sessionStorage.clear();
}
if(!document.__defineGetter__) {
  Object.defineProperty(document, 'cookie', {
    get: function(){return ''},
    set: function(){return true},
  });
} else {
  document.__defineGetter__("cookie", function() { return '';} );
  document.__defineSetter__("cookie", function() {} );
}
</script>
<!-- See https://realfavicongenerator.net -->
<link href="https://elastisys.io/compliantkubernetes/img/apple-touch-icon.png?v=1" rel="apple-touch-icon" sizes="180x180"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon-32x32.png?v=1" rel="icon" sizes="32x32" type="image/png"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon-16x16.png?v=1" rel="icon" sizes="16x16" type="image/png"/>
<link href="https://elastisys.io/compliantkubernetes/img/site.webmanifest?v=1" rel="manifest"/>
<link color="#5bbad5" href="https://elastisys.io/compliantkubernetes/img/safari-pinned-tab.svg?v=1" rel="mask-icon"/>
<link href="https://elastisys.io/compliantkubernetes/img/favicon.ico?v=1" rel="shortcut icon"/>
<meta content="#2b5797" name="msapplication-TileColor"/>
<meta content="https://elastisys.io/compliantkubernetes/img/browserconfig.xml?v=1" name="msapplication-config"/>
<meta content="#ffffff" name="theme-color"/>
<link href="../../../assets/stylesheets/extra-style._liu4anl.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="elastisys" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#reduce-blast-radius-enforcing-restricted-privileges">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Elastisys Compliant Kubernetes" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Elastisys Compliant Kubernetes">
<img alt="logo" src="../../../img/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Elastisys Compliant Kubernetes
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Enforce Restricted Privileges
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<ul class="header-links">
<li>
<a href="https://github.com/elastisys/compliantkubernetes/">
<img alt="Git logo" src="../../../img/git-alt.svg" width="25px">
</img></a>
</li>
<li><a class="menu-callout" href="https://elastisys.com/">Try out Managed<br/>Compliant Kubernetes</a></li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Elastisys Compliant Kubernetes" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Elastisys Compliant Kubernetes">
<img alt="logo" src="../../../img/logo.png"/>
</a>
    Elastisys Compliant Kubernetes
  </label>
<div class="md-nav__source">
<ul class="header-links">
<li>
<a href="https://github.com/elastisys/compliantkubernetes/">
<img alt="Git logo" src="../../../img/git-alt.svg" width="25px">
</img></a>
</li>
<li><a class="menu-callout" href="https://elastisys.com/">Try out Managed<br/>Compliant Kubernetes</a></li>
</ul>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Overview
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          For Application Developers
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          For Application Developers
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../prepare/">
        Step 1: Prepare
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../deploy/">
        Step 2: Deploy
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../operate/">
        Step 3: Operate
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Go Deeper
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          Go Deeper
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../prepare-application/">
        Prepare Your Application
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../prepare-idp/">
        Prepare Your Identity Provider (IdP)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../registry/">
        Container registry
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../continous-development/">
        Continous Development
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../network-model/">
        Network Model
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kubernetes-api/">
        Kubernetes API
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kubernetes-ui/">
        Kubernetes UI (Lens)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../namespaces/">
        Namespaces
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../logs/">
        Logs
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../log-based-alerts/">
        Log-based Alerts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../long-term-log-retention/">
        Long-term Log Retention
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../metrics/">
        Metrics
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../alerts/">
        Metric Alerts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../maintenance/">
        Maintenance
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../backup/">
        Backups
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ci-cd/">
        CI/CD
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../demarcation/">
        Demarcation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../delegation/">
        How to Delegate
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-many-environments/">
        How many environments?
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Safeguards
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
          Safeguards
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../enforce-no-root/">
        Enforce No Root
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Enforce Restricted Privileges
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Enforce Restricted Privileges
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#restricted-pod-security-standard">
    Restricted Pod Security Standard
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-pod-security-policy">
    Custom Pod Security Policy
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../enforce-networkpolicies/">
        Enforce NetworkPolicies
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../enforce-resources/">
        Enforce Resources
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../enforce-trusted-registries/">
        Enforce Trusted Registries
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../enforce-no-latest-tag/">
        Enforce No Latest Tag
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../enforce-job-ttl/">
        Enforce Job TTL
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          Additional Services
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
          Additional Services
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-services/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-services/postgresql/">
        PostgreSQL
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-services/timescaledb/">
        TimescaleDB
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-services/redis/">
        Redis
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-services/rabbitmq/">
        RabbitMQ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-services/jaeger/">
        Jaeger (preview)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../additional-services/argocd/">
        Argo CD (preview)
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
          Self-Managed Services
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
          Self-Managed Services
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../self-managed-services/ferretdb/">
        FerretDB (self-managed)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../self-managed-services/keycloak/">
        Keycloak (self-managed)
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../go-live/">
        Go-live Checklist
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../troubleshooting/">
        Troubleshooting
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/">
        FAQ
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          For Platform Administrators
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          For Platform Administrators
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/getting-started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/provider-audit/">
        Provider Audit
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/on-prem-standard/">
        Standard Template for on-prem Environment
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/qa/">
        QA
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Advanced Configuration
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
          Advanced Configuration
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/configure/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/cluster-sizing/">
        Sizing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/ingress/">
        Ingress
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/access-control/">
        Access Control
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/user-alerts/">
        User Alerts
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/disaster-recovery/">
        Disaster Recovery
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/break-glass/">
        Breaking the Glass
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/cryptography/">
        Use of Cryptography
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/credentials/">
        Use of Credentials
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/capacity-management/">
        Capacity Management
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/clock-synchronization/">
        Clock Synchronization
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/maintenance/">
        Maintenance
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/clean-up/">
        Clean Up
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/troubleshooting/">
        Troubleshooting
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/faq/">
        FAQ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../operator-manual/additional-services/">
        Additional Services
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          For CISOs and DPOs
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          For CISOs and DPOs
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/controls/iso-27001/">
        ISO 27001
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/controls/hslf-fs-201640/">
        HSLF-FS 2016:40
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/controls/msbfs-20207/">
        MSBFS 2020:7
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/controls/gdpr/">
        GDPR
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/controls/hipaa/">
        HIPAA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/controls/bsi-it-grundschutz/">
        BSI IT-Grundschutz
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/controls/mdr/">
        MDR
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
          CISO Dashboards
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_9">
<span class="md-nav__icon md-icon"></span>
          CISO Dashboards
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/audit-logs/">
        Audit Logs
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/backup/">
        Backup Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/cryptography/">
        Cryptography Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/intrusion-detection/">
        Intrusion Detection Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/policy-as-code/">
        Policy-as-Code Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/network-security/">
        Network Security Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/capacity-management/">
        Capacity Management (Kubernetes Status) Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/vulnerability/">
        Vulnerability Dashboard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/log-review/">
        Log Review
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/faq/">
        FAQ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ciso-guide/gdpr-art-17/">
        How do I comply with GDPR Art. 17 Right to erasure ("right to be forgotten")?
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          For Contributors
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          For Contributors
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contributor-guide/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../architecture/">
        Architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../adr/">
        Architectural Decision Log
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tech-radar/">
        Tech Radar
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release-notes/ck8s/">
        Compliant Kubernetes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release-notes/kubespray/">
        CK8S Kubespray
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release-notes/postgres/">
        CK8S PostgreSQL
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release-notes/rabbitmq/">
        CK8S RabbitMQ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release-notes/redis/">
        CK8S Redis
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release-notes/jaeger/">
        CK8S Jaeger
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release-notes/argocd/">
        CK8S Argo CD
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../glossary/">
        Glossary
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../roadmap/">
        Roadmap
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/">
        Support
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/training/">
        Training
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/blog/">
        Blog
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://elastisys.com/legal/privacy-policy/">
        Privacy Policy
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#restricted-pod-security-standard">
    Restricted Pod Security Standard
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-pod-security-policy">
    Custom Pod Security Policy
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="reduce-blast-radius-enforcing-restricted-privileges">Reduce blast radius: Enforcing restricted privileges<a class="headerlink" href="#reduce-blast-radius-enforcing-restricted-privileges" title="Permanent link">¶</a></h1>
<p>This page helps you understand why warnings are emitted when deploying workloads similar to:</p>
<div class="highlight"><pre><span></span><code><span class="go">Warning: would violate PodSecurity "restricted:latest":</span>
<span class="go">    allowPrivilegeEscalation != false (container "&lt;container-name&gt;" must set securityContext.allowPrivilegeEscalation=false),</span>
<span class="go">    unrestricted capabilities (container "&lt;container-name&gt;" must set securityContext.capabilities.drop=["ALL"]),</span>
<span class="go">    runAsNonRoot != true (container "&lt;container-name&gt;" must not set securityContext.runAsNonRoot=false),</span>
<span class="go">    seccompProfile (pod or container "&lt;container-name&gt;" must set securityContext.seccompProfile.type to "RuntimeDefault" or "Localhost")</span>
</code></pre></div>
<p>Additionally, why pods are not scheduled and events are emitted from workloads similar to:
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>kubectl<span class="w"> </span>-n<span class="w"> </span>&lt;namespace&gt;<span class="w"> </span>get<span class="w"> </span>events
<span class="go">...</span>
<span class="go">&lt;time&gt;    Warning    FailedCreate    replicaset/&lt;replicaset-name&gt;    Error creating: pods "&lt;pod-name&gt;" is forbidden: violates PodSecurity "restricted:latest": runAsNonRoot != true (container "&lt;container-name&gt;" must not set securityContext.runAsNonRoot=false)</span>
<span class="go">...</span>
</code></pre></div></p>
<div class="admonition elastisys">
<p class="admonition-title">For Elastisys Managed Services Customers</p>
<p>These restrictions are put in place to protect <strong>your</strong> data. They are meant to help you comply with GDPR. For more details, please read our Terms of Service, specifically:</p>
<ul>
<li><a href="https://elastisys.com/legal/terms-of-service/#a13-security-measures">ToS A1.3 Security Measures</a></li>
<li><a href="https://elastisys.com/legal/terms-of-service/#a23-safeguards">ToS A2.3 Safeguards</a>.</li>
</ul>
<p>If any of these restrictions causes friction when deploying your application, please file a <a href="https://elastisys.atlassian.net/servicedesk/">service ticket</a> and we'll happily advise you on how to reduce privileges required by your application.</p>
</div>
<p>Kubernetes by default allows any Pod to run with any privileges it requests, which easily allows an application to take full control over a cluster and everything in it.
To minimise this risk Compliant Kubernetes employs two systems to restrict what privileges an application can request:</p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/security/pod-security-admission/">Kubernetes - Pod Security Admission</a> (PSA)<ul>
<li>Coarse-grained enforcement built into Kubernetes</li>
</ul>
</li>
<li><a href="https://github.com/open-policy-agent/gatekeeper-library/tree/master/library/pod-security-policy/">Open Policy Agent Gatekeeper - Pod Security Policies</a> (PSP)<ul>
<li>Fine-grained enforcement built with OPA Gatekeeper</li>
</ul>
</li>
</ul>
<p>In addition to enforcement Compliant Kubernetes also employ OPA Gatekeeper mutations to modify security contexts of applications to make it easier to comply with the enforced rules.
This modification happens at the stage when Pods are created, which means that their security context may contain additional content compared to the resource they were created for.
Only fields that are unset can be modified in this way.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This means that Kubernetes may warn on workloads that may be permitted based on the results of the mutations.
Example of this will follow below.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model is used to emulate the behaviour of <a href="https://kubernetes.io/blog/2021/04/06/podsecuritypolicy-deprecation-past-present-and-future/">Kubernetes own Pod Security Policies which have been deprecated and removed in favour of Pod Security Admission</a>.</p>
<p>One limitation with the OPA Gatekeeper constraints and mutations is that they target resource only based on labels, in contrast to the old Pod Security Policies which gave access to additional permissions through Kubernetes RBAC.</p>
</div>
<h2 id="restricted-pod-security-standard">Restricted Pod Security Standard<a class="headerlink" href="#restricted-pod-security-standard" title="Permanent link">¶</a></h2>
<p>The default enforcement in Compliant Kubernetes follows the upstream <a href="https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted">Restricted Pod Security Standard as defined by Kubernetes</a>.
This standard includes the following:</p>
<ul>
<li>
<p>Escalation and privileged mode are disallowed.</p>
<p>Usually applications don't need this unless they need to have low-level access to the nodes to access and manage hardware</p>
</li>
<li>
<p>Host namespaces, host networks, host ports, and host paths are disallowed</p>
<p>Usually applications don't need this unless they need to have low-level access to the nodes to access and manage system resources.</p>
</li>
<li>
<p>Running with the seccomp profile <code>Localhost</code> or <code>RuntimeDefault</code> (set by default)</p>
<p>This restricts the system call applications can make, <a href="https://github.com/containerd/containerd/blob/main/contrib/seccomp/seccomp_default.go#L55">the <code>RuntimeDefault</code> profile is provided by containerd</a>, the container runtime, with sane default that should not be an issue for most applications.</p>
</li>
<li>
<p>Running as non root user (with a non-zero UID)</p>
<p>Recommended is to run a high UID and GID over 10000 that doesn't match with other running software.</p>
</li>
<li>
<p>Running with the <code>NET_BIND_SERVICE</code> capability added and <code>ALL</code> capabilities dropped (set by default)</p>
<p>Usually applications don't need any capabilities unless they need to have low-level access to the nodes to access and manage system resources. The <code>NET_BIND_SERVICE</code> is an exception that allows processes to bind ports under 1024.</p>
</li>
<li>
<p>Running with the following volume types:</p>
<ul>
<li>configMap</li>
<li>csi</li>
<li>downwardAPI</li>
<li>emptyDir</li>
<li>ephemeral</li>
<li>persistentVolumeClaim</li>
<li>projected</li>
<li>secret</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This standard only enforces that <code>runAsNonRoot</code> is set to <code>true</code>, one must still either configure a numerical user in the container image or with <code>runAsUser</code> that is non-zero for the Pod to be allowed as described in <a href="../enforce-no-root/">Enforce No Root</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This standard does not enforce <code>fsGroup</code>, <code>runAsGroup</code> and <code>supplementalGroups</code> to be non-zero, however these will be set to <code>1</code> by default.</p>
</div>
<details class="example">
<summary>Example of a minimal Pod template and the resulting mutated Pod spec</summary>
<p>This example of a minimal Pod template does not conform to the Restricted Pod Security Standard, and will generate warnings as they are applied.
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">templates</span><span class="p">:</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">          </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">            </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span><span class="w"> </span><span class="c1"># May be skipped if the Contatinerfile / Dockerfile contains the USER directive with numerical user</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">securityContext</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div></p>
<p>However with the help of mutations the template will turn into this Pod spec that conforms to the restricted standard:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">        </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">        </span><span class="nt">runAsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">seccompProfile</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RuntimeDefault</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">          </span><span class="nt">drop</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ALL</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">hostIPC</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">hostPID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">    </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">supplementalGroups</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>It is still recommended that non-conforming workloads are updated to conform to the restricted standard and with the minimal set of privileges it requires.</p>
</details>
<h2 id="custom-pod-security-policy">Custom Pod Security Policy<a class="headerlink" href="#custom-pod-security-policy" title="Permanent link">¶</a></h2>
<p>Certain applications may need more privileges than what is allowed from the restricted standard, and platform administrators may configure custom policies to allow application developers more freedom to applications in certain namespaces.</p>
<p>To do so application developers should put together a Pod Security Policy to be evaluated and accepted by the platform administrator, which then can allow access to these privileges in a certain namespace for resources with a certain label.
The format should be as follows:
<div class="highlight"><pre><span></span><code><span class="nt">podSelectorLabels</span><span class="p">:</span><span class="w"> </span><span class="c1"># Must be provided</span>
<span class="w">  </span><span class="nt">&lt;key&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;value&gt;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">allow</span><span class="p">:</span>
<span class="w">  </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;boolean&gt;</span><span class="w"> </span><span class="c1"># Default false</span>
<span class="w">  </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;boolean&gt;</span><span class="w"> </span><span class="c1"># Default false</span>
<span class="w">  </span><span class="nt">allowedCapabilities</span><span class="p">:</span><span class="w"> </span><span class="c1"># Default empty</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;linux capability&gt;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">allowedUnsafeSysctls</span><span class="p">:</span><span class="w"> </span><span class="c1"># Default empty (1)</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;unsafe sysctl&gt;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">hostNetworkPorts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;boolean&gt;</span><span class="w"> </span><span class="c1"># Default false (2)</span>
<span class="w">  </span><span class="nt">hostNamespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;boolean&gt;</span><span class="w"> </span><span class="c1"># Default false</span>
<span class="w">  </span><span class="nt">allowedHostPaths</span><span class="p">:</span><span class="w"> </span><span class="c1"># Default empty</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pathPrefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;hostpath&gt;</span>
<span class="w">      </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;boolean&gt;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MustRunAsNonRoot | RunAsAny</span><span class="w">  </span><span class="c1"># Default MustRunAsNonRoot</span>
<span class="w">  </span><span class="nt">runAsGroup</span><span class="p">:</span>
<span class="w">    </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MustRunAs | RunAsAny</span><span class="w"> </span><span class="c1"># Default RunAsAny</span>
<span class="w">    </span><span class="nt">ranges</span><span class="p">:</span><span class="w"> </span><span class="c1"># Only required with MustRunAs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span>
<span class="w">        </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">fsGroup</span><span class="p">:</span>
<span class="w">    </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MustRunAs | RunAsAny</span><span class="w"> </span><span class="c1"># Default RunAsAny</span>
<span class="w">    </span><span class="nt">ranges</span><span class="p">:</span><span class="w"> </span><span class="c1"># Only required with MustRunAs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span>
<span class="w">        </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">supplementalGroups</span><span class="p">:</span>
<span class="w">    </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MustRunAs | RunAsAny</span><span class="w"> </span><span class="c1"># Default RunAsAny</span>
<span class="w">    </span><span class="nt">ranges</span><span class="p">:</span><span class="w"> </span><span class="c1"># Only required with MustRunAs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span>
<span class="w">        </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span><span class="w"> </span><span class="c1"># Default [ configMap, downwardAPI, emptyDir, persistentVolumeClaim, projected, secret ]</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;volume-type&gt;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">mutations</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dropAllCapabilities</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;boolean&gt;</span><span class="w"> </span><span class="c1"># Default true</span>
<span class="w">  </span><span class="nt">setDefaultSeccompProfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;boolean&gt;</span><span class="w"> </span><span class="c1"># Default true</span>
<span class="w">  </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;UID&gt;</span><span class="w"> </span><span class="c1"># Default none (3)</span>
<span class="w">  </span><span class="nt">runAsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span><span class="w"> </span><span class="c1"># Default 1</span>
<span class="w">  </span><span class="nt">fsGroup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;GID&gt;</span><span class="w"> </span><span class="c1"># Default 1</span>
</code></pre></div></p>
<ol>
<li>Sysctls may still be denied by the kubelet.</li>
<li>Allows both host network and host ports.</li>
<li>Must be configured in the container image or security context.</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Custom Pod Security Policies opens the platform up for potential security threats and should be as restrictive as possible and to a minimum to safeguard the security of the platform!</p>
</div>
<details class="example">
<summary>Example of a Pod manifest with higher privileges and associated custom Pod Security Policy</summary>
<p>This Pod manifest for an application that would be capable of modifying routes on nodes:
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">route-manager</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">route-manager</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">manager</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">securityContext</span><span class="p">:</span>
<span class="w">        </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"> </span><span class="c1"># (1)!</span>
<span class="w">        </span><span class="nt">runAsNonRoot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">runAsUser</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">400</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">          </span><span class="nt">add</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_ADMIN</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">hostNetwork</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div></p>
<ol>
<li>Required when adding privileges that exceed the container runtime, in this case the <code>NET_ADMIN</code> capability.</li>
</ol>
<p>Would translate into this Pod Security Policy:
<div class="highlight"><pre><span></span><code><span class="nt">podSelectorLabels</span><span class="p">:</span>
<span class="w">  </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">route-manager</span>
<span class="nt">allow</span><span class="p">:</span>
<span class="w">  </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">allowedCapabilities</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_ADMIN</span>
<span class="w">  </span><span class="nt">hostNetworkPorts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">runAsUser</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MustRunAs</span>
<span class="w">  </span><span class="nt">ranges</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">400</span>
<span class="w">      </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">400</span>
</code></pre></div></p>
</details>
</article>
</div>
<script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Back to top
          </button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Enforce No Root" class="md-footer__link md-footer__link--prev" href="../enforce-no-root/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Enforce No Root
              </div>
</div>
</a>
<a aria-label="Next: Enforce NetworkPolicies" class="md-footer__link md-footer__link--next" href="../enforce-networkpolicies/" rel="next">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Enforce NetworkPolicies
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © Elastisys AB <br/> The Linux Foundation has the following registered trademarks in the United States and/or other countries: Certified Kubernetes®, containerd®, fluentd®, Helm®, Istio®, K8s®, Kubernetes®, Prometheus®, PromQL®, Rook®, The Linux Foundation®. <br/> The Linux Foundation has registrations pending or trademarks in use for the following marks in the United States and/or other countries: Argo™, CoreDNS™, Falco™, Harbor™, Jaeger™, Linux Foundation™, OpenTelemetry™, OpenTracing™, Open Policy Agent™, Tekton™, Thanos™. <br/> Postgres and PostgreSQL and the Elephant Logo (Slonik) are all registered trademarks of the PostgreSQL Community Association of Canada. <br/> Redis is a trademark of Redis Ltd. Any rights therein are reserved to Redis Ltd. Any use by the Compliant Kubernetes project is for referential purposes only and does not indicate any sponsorship, endorsement or affiliation between Redis and Compliant Kubernetes project. <br/> RabbitMQ is a trademark of VMware, Inc. in the U.S. and other countries. <br/> TimescaleDB and the EON mascot are trademarks of <a href="https://www.timescale.com/">Timescale, Inc.</a> <br/> FerretDB® is a registered trademark of FerretDB, Inc. FerretDB Inc. is not affiliated, associated, authorized, endorsed by, or in any way officially connected with MongoDB Inc., or any of its subsidiaries or its affiliates. <br/> MongoDB, Mongo, and the leaf logo are registered trademarks of MongoDB, Inc. <br/> Keycloak™ is a trademark of Red Hat Inc. <br/> OpenSearch is a registered trademark of Amazon Web Services. <br/> NGINX is a registered trademark of F5 Inc.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "navigation.footer", "navigation.top"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
<script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
</body>
</html>